<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>ChatSpace</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Signika:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
  <style>
    .ic--baseline-auto-awesome::after {
      display: inline-block;
      width: 24px;
      height: 24px;
      vertical-align: -0.125em;
      content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffa6a6' d='m19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25zm-7.5.5L9 4L6.5 9.5L1 12l5.5 2.5L9 20l2.5-5.5L17 12zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25z'/%3E%3C/svg%3E");
    }
    .material-symbols--verified::after {
      display: inline-block;
      width: 24px;
      height: 24px;
      vertical-align: -0.125em;
      content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%235abd80' d='m8.6 22.5l-1.9-3.2l-3.6-.8l.35-3.7L1 12l2.45-2.8l-.35-3.7l3.6-.8l1.9-3.2L12 2.95l3.4-1.45l1.9 3.2l3.6.8l-.35 3.7L23 12l-2.45 2.8l.35 3.7l-3.6.8l-1.9 3.2l-3.4-1.45zm2.35-6.95L16.6 9.9l-1.4-1.45l-4.25 4.25l-2.15-2.1L7.4 12z'/%3E%3C/svg%3E");
    }
    .solar--clipboard-bold::after {
      display: inline-block;
      width: 24px;
      height: 24px;
      vertical-align: -0.125em;
      content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23e5edf1' d='M8 3.5A1.5 1.5 0 0 1 9.5 2h5A1.5 1.5 0 0 1 16 3.5v1A1.5 1.5 0 0 1 14.5 6h-5A1.5 1.5 0 0 1 8 4.5z'/%3E%3Cpath fill='%23e5edf1' fill-rule='evenodd' d='M6.5 4.037c-1.258.07-2.052.27-2.621.84C3 5.756 3 7.17 3 9.998v6c0 2.829 0 4.243.879 5.122c.878.878 2.293.878 5.121.878h6c2.828 0 4.243 0 5.121-.878c.879-.88.879-2.293.879-5.122v-6c0-2.828 0-4.242-.879-5.121c-.569-.57-1.363-.77-2.621-.84V4.5a3 3 0 0 1-3 3h-5a3 3 0 0 1-3-3zM6.25 10.5A.75.75 0 0 1 7 9.75h10a.75.75 0 0 1 0 1.5H7a.75.75 0 0 1-.75-.75m1 3.5a.75.75 0 0 1 .75-.75h8a.75.75 0 0 1 0 1.5H8a.75.75 0 0 1-.75-.75m1 3.5a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75' clip-rule='evenodd'/%3E%3C/svg%3E");
    }
    .fluent--send-20-filled::after {
      display: inline-block;
      width: 20px;
      height: 20px;
      vertical-align: -0.125em;
      content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath fill='%2331b1f0' d='M2.724 2.053a.5.5 0 0 0-.707.576l1.498 5.618a.5.5 0 0 0 .4.364l6.855 1.142c.279.047.279.447 0 .494l-6.854 1.142a.5.5 0 0 0-.401.364l-1.498 5.618a.5.5 0 0 0 .707.576l15-7.5a.5.5 0 0 0 0-.894z'/%3E%3C/svg%3E");
    }
  </style>
</head>
<body class="bg-black text-white font-sans" style="font-family: 'Signika', sans-serif;">
  <div class="max-w-lg mx-auto p-4">
    <!-- Header -->
    <div class="sticky top-0 bg-black z-10">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center space-x-4">
          <img alt="Group Icon" class="w-12 h-12 rounded-full" height="50" src="./224_Spaces.png" width="50"/>
          <div>
            <h1 class="text-xl font-bold flex items-center">
              Genis Protocol
              <span class="material-symbols--verified ml-2"></span>
            </h1>
            <p class="text-xs text-gray-400 uppercase">Private Members</p>
          </div>
        </div>
        <div class="ic--baseline-auto-awesome"></div>
      </div>
      <!-- Divider Line -->
      <hr class="border-gray-700 mb-4"/>
      <!-- Announcement -->
      <div class="bg-gray-800 p-2 text-sm text-blue-400 rounded-lg">
        <i class="fas fa-exclamation-triangle"></i>
        - Don't send unnecessary messages or you will be banned !
      </div>
    </div>
    <!-- Chat Messages -->
    <div class="space-y-2 mb-20" id="chat-messages">
      <!-- No messages initially -->
    </div>
    <!-- Message Input -->
    <div class="fixed bottom-0 left-0 right-0 bg-black p-2 flex items-center space-x-2">
      <input class="w-full bg-gray-700 p-2 rounded-lg text-white text-sm" id="message-input" placeholder="Message" type="text"/>
      <div class="fluent--send-20-filled cursor-pointer" id="send-button"></div>
      <div class="solar--clipboard-bold cursor-pointer" id="paste-button"></div>
    </div>
  </div>
  <script>
    const chatMessages = document.getElementById('chat-messages');
    const messageInput = document.getElementById('message-input');
    const sendButton = document.getElementById('send-button');
    const pasteButton = document.getElementById('paste-button');
    let chatId = new URLSearchParams(window.location.search).get('id') || generateChatId();
    const chatStorageKey = `chat_${chatId}`;
    const userId = generateUserId();

    function generateChatId() {
      return Math.random().toString(36).substring(2, 8);
    }

    function generateUserId() {
      let userId = localStorage.getItem('user_id');
      if (!userId) {
        userId = Math.random().toString(36).substring(2, 8);
        localStorage.setItem('user_id', userId);
      }
      return userId;
    }

    function addMessage(text, senderId) {
      const isOwnMessage = senderId === userId;
      const messageElement = document.createElement('div');
      messageElement.classList.add('flex', 'items-start', 'space-x-2', isOwnMessage ? 'justify-end' : 'justify-start');
      messageElement.innerHTML = `
        <div class="${isOwnMessage ? 'order-2' : 'order-1'} bg-gray-800 p-2 rounded-lg text-sm">
          <p>${text}</p>
          <p class="text-gray-400 text-xs">${new Date().toLocaleTimeString()}</p>
        </div>
      `;
      chatMessages.appendChild(messageElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      saveMessage({ text, senderId, time: new Date().toLocaleTimeString() });
    }

    function saveMessage(message) {
      const chatHistory = JSON.parse(localStorage.getItem(chatStorageKey)) || [];
      chatHistory.push(message);
      localStorage.setItem(chatStorageKey, JSON.stringify(chatHistory));
    }

    function loadMessages() {
      const chatHistory = JSON.parse(localStorage.getItem(chatStorageKey)) || [];
      chatHistory.forEach(message => addMessage(message.text, message.senderId));
    }

    function updateUrlWithChatId() {
      const url = new URL(window.location);
      url.searchParams.set('id', chatId);
      window.history.pushState({}, '', url);
    }

    sendButton.addEventListener('click', function() {
      const messageText = messageInput.value.trim();
      if (messageText !== '') {
        addMessage(messageText, userId);
        messageInput.value = '';
        updateUrlWithChatId();
      }
    });

    pasteButton.addEventListener('click', async function() {
      try {
        const text = await navigator.clipboard.readText();
        messageInput.value = text;
      } catch (err) {
        console.error('Failed to read clipboard contents: ', err);
      }
    });

    window.addEventListener('load', function() {
      const path = new URLSearchParams(window.location.search).get('id');
      if (path === 'clear') {
        chatMessages.innerHTML = '';
        localStorage.removeItem(chatStorageKey);
      } else {
        loadMessages();
      }
    });
  </script>
</body>
   </html>
